<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Login & Sign Up</title>
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light p-5">

<div class="container">
  <div class="row justify-content-center">
    <div class="col-md-6">

      <!-- Login Form -->
      <div id="loginForm" class="card p-4 shadow">
        <h3 class="mb-3">Login</h3>
        <div class="mb-3">
          <label for="loginUsername" class="form-label">Username</label>
          <input type="text" class="form-control" id="loginUsername" required>
        </div>
        <div class="mb-3">
          <label for="loginPassword" class="form-label">Password</label>
          <input type="password" class="form-control" id="loginPassword" required>
        </div>
        <button id="loginBtn" class="btn btn-primary w-100">Login</button>
        <p class="mt-3 text-center">
          Don't have an account?
          <a href="#" id="showSignup">Create an account</a>
          <br> <button id="deleteAccountBtn" class="btn btn-danger mt-3 d-none">Delete My Account</button>

        </p>
      </div>

      <!-- Signup Form -->
      <div id="signupForm" class="card p-4 shadow d-none">
        <h3 class="mb-3">Sign Up</h3>
        <div class="mb-3">
          <label for="signupUsername" class="form-label">Username</label>
          <input type="text" class="form-control" id="signupUsername" required>
        </div>
        <div class="mb-3">
          <label for="signupPassword" class="form-label">Password</label>
          <input type="password" class="form-control" id="signupPassword" required>
        </div>
        <button id="signupBtn" class="btn btn-success w-100">Sign Up</button>
        <p class="mt-3 text-center">
          Already have an account?
          <a href="#" id="showLogin">Sign In</a>
        </p>
      </div>

      <!-- Alert Message -->
      <div id="alert" class="alert mt-3 d-none" role="alert"></div>

    </div>
  </div>
</div>

<script>
  $(document).ready(function () {
    // Show Sign Up
    $('#showSignup').click(function (e) {
      e.preventDefault();
      $('#loginForm').addClass('d-none');
      $('#signupForm').removeClass('d-none');
      $('#alert').addClass('d-none');
      $('#loginUsername, #loginPassword').val('');
    });

    // Show Login
    $('#showLogin').click(function (e) {
      e.preventDefault();
      $('#signupForm').addClass('d-none');
      $('#loginForm').removeClass('d-none');
      $('#alert').addClass('d-none');
       $('#signupUsername, #signupPassword').val('');
    });

    // Sign Up Handler
   $('#signupBtn').click(function () {
  const username = $('#signupUsername').val().trim();
  const password = $('#signupPassword').val().trim();

  // Get existing users from localStorage
  let users = JSON.parse(localStorage.getItem('users')) || [];

  // Check if user already exists
  const userExists = users.find(user => user.username === username);
  if (userExists) {
    showAlert('User already exists. Please log in.', 'danger');
    $('#signupUsername, #signupPassword').val('');
    return;
  }

  // Add new user to the array
  users.push({ username, password });

  // Store updated users array
  localStorage.setItem('users', JSON.stringify(users));

  showAlert('Sign-up successful! You can now log in.', 'success');
  $('#signupForm').addClass('d-none');
  $('#loginForm').removeClass('d-none');
  $('#signupUsername, #signupPassword').val('');
});


    // Login Handler
    $('#loginBtn').click(function () {
  const username = $('#loginUsername').val().trim();
  const password = $('#loginPassword').val().trim();

  // Get users from localStorage
  const users = JSON.parse(localStorage.getItem('users')) || [];

  // Find the user
  const matchedUser = users.find(user => user.username === username && user.password === password);

  if (matchedUser) {
  showAlert('Login successful!', 'success');
  localStorage.setItem('loggedInUser', username);
  $('#deleteAccountBtn').removeClass('d-none');
} else {
  showAlert('Incorrect username or password, or user does not exist.', 'danger');
}
  $('#loginUsername, #loginPassword').val('');
});


  $('#deleteAccountBtn').click(function () {
  const username = localStorage.getItem('loggedInUser');
  if (!username) {
    showAlert('No user logged in.', 'danger');
    return;
  }

  // Get existing users and remove the logged-in one
  let users = JSON.parse(localStorage.getItem('users')) || [];
  users = users.filter(user => user.username !== username);
  localStorage.setItem('users', JSON.stringify(users));

  // Clear login state
  localStorage.removeItem('loggedInUser');
  showAlert('Your account has been deleted.', 'success');

  // Reset form view
  $('#loginForm').removeClass('d-none');
  $('#signupForm').addClass('d-none');
  $('#deleteAccountBtn').addClass('d-none');
  $('#loginUsername, #loginPassword').val('');
});
$(document).ready(function () {
  const loggedInUser = localStorage.getItem('loggedInUser');
  if (loggedInUser) {
    $('#deleteAccountBtn').removeClass('d-none');
  } else {
    $('#deleteAccountBtn').addClass('d-none');
  }
});
function showAlert(message, type) {
      $('#alert')
        .removeClass()
        .addClass(`alert alert-${type}`)
        .text(message)
        .removeClass('d-none');
    }
  });

</script>

</body>
</html>
